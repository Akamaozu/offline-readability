var express = require('express'),
    server = express(),

    path_to_client_dir = __dirname + '/../client';

// load api routes
  server.use('/api/1', require('app/server/routes/api/v1') );

// serve styles and scripts
  server.use('/css', express.static( path_to_client_dir + '/css' ) );
  server.use('/js', express.static( path_to_client_dir + '/js' ) );

// set rendering engine
  server.set('view engine', 'ejs');

// render and server app
  server.get('/', function( req, res ){

    var ReactDOMServer = require('react-dom/server');

    var layout = ReactDOMServer.renderToString( require('app/client/src/js/logged-out-page') );

    res.render( path_to_client_dir + '/index.ejs', { react_server_render: layout });
  });

server.listen( process.env.PORT, function(){

  console.log('[SERVER] STARTED ON PORT ' + process.env.PORT );
});