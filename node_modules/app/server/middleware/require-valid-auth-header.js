module.exports = function require_valid_auth_header( req, res, next ){
  
  // filter no authorization header  
    if( !req.headers.authorization ) return res.status( 400 ).send( 'Authorization Header Missing' );

  // get jwt token
    var jwt = req.headers.authorization.split( 'Bearer ', 2 )[ 1 ];

  // filter no jwt token
    if( !jwt ) return res.status( 400 ).send( 'Malformed Authorization Header - Format is "Bearer token"' );

  // get token content
    var jwt_content = require('jwt-simple').decode( jwt, process.env.JWT_USER_TOKEN_SECRET );

  // filter no token content
    if( !jwt_content.oauth_token || !jwt_content.oauth_token_secret ) return res.status( 400 ).send( 'Invalid Authorization Token' );

  // mount token content for routes / other middleware
    req.auth = jwt_content;

  next();
}