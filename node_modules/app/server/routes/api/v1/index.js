var api_routes = module.exports = require('express').Router();

// parse form submissions
  api_routes.use( require('body-parser').urlencoded({ extended: false }) );

// routes
  api_routes.post('/login', function( req, res ){
    
    var readability = require('app/server/modules/readability');

    readability.login( req.body.user, req.body.pass, function( error, tokens ){

      if( error ) return res.status( 400 ).send( error.toString() );
      
      var signed_tokens = require('jwt-simple').encode( tokens, process.env.JWT_USER_TOKEN_SECRET );

      res.send( signed_tokens );
    });
  });

  api_routes.use('/bookmarks', require('app/server/routes/api/v1/bookmarks') );
  api_routes.use('/favorites', require('app/server/routes/api/v1/favorites') );
  api_routes.use('/archives', require('app/server/routes/api/v1/archives') );
  api_routes.use('/article', require('app/server/routes/api/v1/article') );